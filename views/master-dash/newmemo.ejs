<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="newmemo.css" />
    <title>RAKE PLACEMENT MEMO</title>
  </head>
  <body>
    <div class="container">
      <!-- Dropdown Menu -->
      <% var showView2 = typeof showView2 !== 'undefined' ? showView2 : false;
      %>
      <div class="dropdown">
        <button class="dropdown-btn">Menu ▼</button>
        <div class="dropdown-content">
          <a href="#" id="option1">Option 1 (Placement Memo)</a>
          <a href="#" id="option2">Option 2 (Placement Acknowledgement)</a>
        </div>
      </div>

      <!-- View 1: Placement Memo -->
      <form action="/newmemo" method="post">
        <div id="view1" class="view1<%= showView2 ? ' hidden' : '' %>">
          <div class="memo-container">
            <div class="memo-header">
              <h1>RAKE PLACEMENT MEMO FOR INTERNAL MOVEMENT</h1>
            </div>

            <div class="form-fields">
              <table>
                <input
                  type="hidden"
                  name="isUpdate"
                  id="isUpdate"
                  value="false"
                />
                <tr class="place-number">
                  <td>Placement Memo No.</td>
                  <td>
                    <input
                      class="clear ip-place"
                      type="text"
                      id="memoNumber-1"
                      name="memoNo"
                      readonly
                    />
                  </td>
                </tr>
                <div
                  id="memoNumberPopup-1"
                  class="popup-list"
                  style="
                    display: none;
                    position: absolute;
                    background: #fff;
                    border: 1px solid #ccc;
                    z-index: 1000;
                    max-height: 200px;
                    overflow: auto;
                  "
                ></div>
                <tr>
                  <td>Date :</td>
                  <td>
                    <input
                      class="clear"
                      type="date"
                      name="memoDate"
                      id="memoDate"
                    />
                  </td>
                </tr>

                <tr>
                  <td>Loading Point :</td>
                  <td>
                    <div class="location-input-group">
                      <input
                        type="text"
                        class="clear loading-point"
                        name="loadingPoint"
                      />
                      <button class="location-btn" data-popup="loadingPopup">
                        ▼
                      </button>
                    </div>
                  </td>
                  <td>
                    <div class="location-input-group">
                      <input
                        type="text"
                        class="clear loading-point-desc"
                        name="loadingPointDesc"
                      />
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>Unloading Point :</td>
                  <td>
                    <div class="location-input-group">
                      <input
                        type="text"
                        class="clear unloading-point"
                        name="unloadingPoint"
                      />
                      <button class="location-btn" data-popup="unloadingPopup">
                        ▼
                      </button>
                    </div>
                  </td>
                  <td>
                    <div class="location-input-group">
                      <input
                        type="text"
                        class="clear unloading-point-desc"
                        name="unloadingPointDesc"
                      />
                    </div>
                  </td>
                </tr>
              </table>
            </div>

            <table class="wagon-table">
              <thead>
                <tr>
                  <th></th>
                  <th>S...</th>
                  <th>Wagon No.</th>
                  <th>Wagon Type</th>
                  <th>Tare</th>
                  <th>Date</th>
                  <th>Remarks</th>
                </tr>
              </thead>
              <tbody>
                <input
                  type="hidden"
                  id="acknowledged"
                  value="<%= memo && memo.acknowledged ? 'true' : 'false' %>"
                />
                <tr>
                  <td><input type="checkbox" name="selected_0" /></td>
                  <td>1.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_0"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="0">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_0"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_0" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_0" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_0" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_1" /></td>

                  <td>2.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_1"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="1">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_1"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_1" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_1" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_1" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_2" /></td>

                  <td>3.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_2"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="2">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_2"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_2" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_2" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_2" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_3" /></td>

                  <td>4.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_3"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="3">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_3"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_3" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_3" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_3" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_4" /></td>

                  <td>5.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_4"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="4">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_4"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_4" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_4" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_4" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_5" /></td>

                  <td>6.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_5"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="5">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_5"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_5" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_5" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_5" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_6" /></td>

                  <td>7.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_6"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="6">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_6"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_6" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_6" />
                  </td>
                  <td><input type="text" name="clear remarks_6" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_7" /></td>

                  <td>8.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="clear wagonNo_7"
                        class="wagon-number"
                      />

                      <button class="action-btn" data-row="7">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_7"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_7" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_7" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_7" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_8" /></td>

                  <td>9.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_8"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="8">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_8"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_8" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_8" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_8" /></td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="selected_9" /></td>

                  <td>10.</td>
                  <td>
                    <div class="wagon-number-container">
                      <input
                        type="text"
                        name="wagonNo_9"
                        class="clear wagon-number"
                      />

                      <button class="action-btn" data-row="9">▼</button>
                    </div>
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear wagon-Type"
                      name="wagonType_9"
                    />
                  </td>
                  <td><input type="text" class="clear" name="tare_9" /></td>
                  <td>
                    <input type="text" class="clear wagon-Date" name="date_9" />
                  </td>
                  <td><input type="text" class="clear" name="remarks_9" /></td>
                </tr>
              </tbody>
            </table>
            <div id="ack-confirm-popup" style="display: none">
              <div class="ack-confirm-content">
                <div class="ack-confirm-message">
                  Are you sure you want to acknowledge this memo?
                </div>
                <div class="ack-confirm-actions">
                  <button id="ack-confirm-yes">Yes</button>
                  <button id="ack-confirm-no">No</button>
                </div>
              </div>
            </div>
            <div class="popup-overlay" id="loadingPopup">
              <div class="popup-content">
                <div class="popup-header">Select Loading Point</div>
                <div class="popup-list">
                  <div
                    class="popup-item"
                    data-code="LP001"
                    data-desc="Main Terminal"
                  >
                    LP001 - Main Terminal
                  </div>
                  <div
                    class="popup-item"
                    data-code="LP002"
                    data-desc="North Station"
                  >
                    LP002 - North Station
                  </div>
                  <div
                    class="popup-item"
                    data-code="LP003"
                    data-desc="South Depot"
                  >
                    LP003 - South Depot
                  </div>
                  <div
                    class="popup-item"
                    data-code="LP004"
                    data-desc="East Junction"
                  >
                    LP004 - East Junction
                  </div>
                </div>
              </div>
            </div>

            <div class="popup-overlay" id="unloadingPopup">
              <div class="popup-content">
                <div class="popup-header">Select Unloading Point</div>
                <div class="popup-list">
                  <div
                    class="popup-item"
                    data-code="UP001"
                    data-desc="Central Hub"
                  >
                    UP001 - Central Hub
                  </div>
                  <div
                    class="popup-item"
                    data-code="UP002"
                    data-desc="West Terminal"
                  >
                    UP002 - West Terminal
                  </div>
                  <div
                    class="popup-item"
                    data-code="UP003"
                    data-desc="Port Station"
                  >
                    UP003 - Port Station
                  </div>
                  <div
                    class="popup-item"
                    data-code="UP004"
                    data-desc="City Depot"
                  >
                    UP004 - City Depot
                  </div>
                </div>
              </div>
            </div>
            <!-- Shared Popup Window -->
            <div class="popup-overlay" id="wagonPopup">
              <div class="popup-content">
                <div class="popup-header">
                  Select Wagon
                  <a class="add-wagon-btn" href="/new-form">
                    <span>+</span>
                  </a>
                </div>
                <div class="popup-list" id="wagonPopupList"></div>
              </div>
            </div>
          </div>
          <div class="button-group">
            <button type="button" class="clear-btn">Clear</button>
            <button type="button" class="confirm">Confirm</button>
            <button type="button" class="dis" style="display: none">
              Display
            </button>
            <button type="submit" class="header-save">Save</button>
            <button type="button" class="print">Placement Memo Report</button>
          </div>
        </div>
      </form>

      <!-- View 2: Loading Completed -->
      <form action="/loadingcompleted" method="post">
        <div id="view2" class="view2<%= showView2 ? '' : ' hidden' %>">
          <div class="memo-container">
            <div class="memo-header">
              <h1>RAKE PLACEMENT ACKNOWLEDGEMENT</h1>
            </div>
            <div class="loading-info">
              <table>
                <tr>
                  <td>Placement Memo No.</td>
                  <td>
                    <input
                      type="text"
                      id="memoNumber-2"
                      class="clear2"
                      name="memoNumber"
                      value="<%= memo ? memo.memoNumber : '' %>"
                    />
                  </td>
                </tr>
                <div
                  id="memoNumberPopup-2"
                  class="popup-list"
                  style="
                    display: none;
                    position: absolute;
                    background: #fff;
                    border: 1px solid #ccc;
                    z-index: 1000;
                    max-height: 200px;
                    overflow: auto;
                  "
                ></div>
                <tr>
                  <td>Date :</td>
                  <td>
                    <input
                      type="date"
                      id="date"
                      class="clear2"
                      name="date"
                      value="<%= memo && memo.date ? memo.date.toISOString().split('T')[0] : '' %>"
                    />
                  </td>
                </tr>
                <tr>
                  <td>Loading Point :</td>
                  <td>
                    <input
                      class="clear2"
                      type="text"
                      id="loadingPoint1"
                      name="loadingPoint1"
                      value="<%= memo && memo.loadingPoint ? memo.loadingPoint.code : '' %>"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      id="loadingPoint2"
                      class="clear2"
                      name="loadingPoint2"
                      value="<%= memo && memo.loadingPoint ? memo.loadingPoint.description : '' %>"
                    />
                  </td>
                </tr>
                <tr>
                  <td>Unloading Point :</td>
                  <td>
                    <input
                      type="text"
                      class="clear2"
                      id="unloadingPoint1"
                      name="unloadingPoint1"
                      value="<%= memo && memo.unloadingPoint ? memo.unloadingPoint.code : '' %>"
                    />
                  </td>
                  <td>
                    <input
                      type="text"
                      class="clear2"
                      id="unloadingPoint2"
                      name="unloadingPoint2"
                      value="<%= memo && memo.unloadingPoint ? memo.unloadingPoint.description : '' %>"
                    />
                  </td>
                </tr>
              </table>
            </div>

            <div class="loading-completed">
              <button type="button" id="ack">Acknowledgement</button>
              <button type="button" id="load" style="display: none">
                Loading completed
              </button>
              <button type="button" id="unloading" style="display: none">
                Unloading
              </button>
              <a id="generateQR" href="#" style="display: none">
                Generate QR
              </a>
              <!-- <div id="qrContainer" style="margin-top: 16px"></div> -->
              <table class="wagon-table" id="wagonTable">
                <thead>
                  <tr>
                    <th style="width: 30px">SNo.</th>
                    <th style="width: 100px">Wagon No.</th>
                    <th>Wagon type</th>
                    <th>Tare</th>
                    <th>Challan No.</th>
                    <th>Challan Date</th>
                    <th>Release Dt</th>
                    <th>Release Time</th>
                    <th>Remarks</th>
                  </tr>
                </thead>
                <tbody>
                  <% for (let i = 0; i < 10; i++) { %>
                  <tr>
                    <td style="width: 30px"><%= i + 1 %></td>
                    <td>
                      <input
                        type="text"
                        name="wagonNumber<%=i%>"
                        class="clear2"
                        style="width: 100px"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].wagonNumber : '' %>"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        name="wagonType<%=i%>"
                        class="clear2"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].wagonType : '' %>"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        name="tare<%=i%>"
                        class="clear2"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].tare : '' %>"
                      />
                    </td>
                    <td class="challan-td" style="visibility: hidden">
                      <input
                        type="text"
                        name="challanNumber<%=i%>"
                        class="clear2 challan-number"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].challan_number : '' %>"
                        readonly
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        name="challanDate<%=i%>"
                        class="clear2"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].wagondate : '' %>"
                      />
                    </td>
                    <td>
                      <input
                        type="date"
                        name="releaseDate<%=i%>"
                        class="clear2 releasedate"
                        value="<%= memo && memo.wagons && memo.wagons[i] && memo.wagons[i].releaseDate ? (memo.wagons[i].releaseDate.includes('-') ? memo.wagons[i].releaseDate.split('T')[0] : '') : '' %>"
                      />
                    </td>
                    <td>
                      <input
                        type="time"
                        name="releaseTime<%=i%>"
                        class="clear2 releasetime"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].releaseTime : '00:00:00' %>"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        name="remarks<%=i%>"
                        class="clear2"
                        value="<%= memo && memo.wagons && memo.wagons[i] ? memo.wagons[i].remarks : '' %>"
                      />
                    </td>
                  </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
          </div>

          <div class="button-group">
            <button type="button" class="clear-bt">Clear</button>
            <button type="button" id="displayBtn">Display</button>
            <button type="submit">Save</button>
            <button type="button" class="print1">Placement Memo Report</button>
            <a class="wt" id="weightReportLink" style="display: none" href="#"
              >weight-report</a
            >
          </div>
        </div>
      </form>
    </div>
    <script src="/memo.js"></script>
  </body>
</html>
